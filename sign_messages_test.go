package bls_tss

import (
	"encoding/json"
	"github.com/stretchr/testify/assert"
	"testing"
)

func TestSignRoundMsg(t *testing.T) {
	example := "{\"sender\":1,\"receiver\":null,\"body\":{\"Round1\":{\"i\":1,\"sigma_i\":{\"curve\":\"bls12_381_1\",\"point\":[180,241,29,232,225,45,142,86,31,161,218,141,169,26,81,81,31,148,124,169,179,121,113,61,146,209,240,199,253,198,34,175,17,16,196,104,82,74,170,101,26,3,124,201,58,174,56,82,7,152,220,130,69,116,214,181,170,43,200,15,213,98,222,233,172,97,66,86,171,39,71,163,90,249,3,91,244,213,237,144,168,80,86,157,98,117,245,84,113,98,21,175,108,37,23,143]},\"ddh_proof\":{\"a1\":{\"curve\":\"bls12_381_1\",\"point\":[179,135,42,17,161,144,114,128,168,47,243,57,226,231,211,196,5,183,165,83,230,217,146,127,107,117,37,221,173,251,135,173,22,28,131,64,83,108,174,9,233,29,32,5,246,121,226,133]},\"a2\":{\"curve\":\"bls12_381_1\",\"point\":[176,243,69,62,45,98,249,65,158,90,150,128,159,194,161,86,242,97,131,40,255,136,29,113,95,240,158,129,84,219,181,238,64,19,149,20,1,255,193,50,110,81,85,171,187,125,55,160,22,73,208,230,120,45,198,242,48,170,202,87,11,204,85,114,255,0,242,215,140,117,246,114,216,173,253,193,162,251,123,226,165,173,248,179,61,237,227,224,183,199,91,244,39,104,61,55]},\"z\":[74,207,31,216,178,211,180,107,72,130,156,238,194,183,174,143,35,160,47,167,45,85,134,202,206,102,234,112,215,147,230,7]}}}}"
	msg := SignRoundMsg{}
	err := json.Unmarshal([]byte(example), &msg)
	assert.Nil(t, err)
	jsonBytes, err := json.Marshal(msg)
	assert.Nil(t, err)
	assert.Equal(t, example, string(jsonBytes))
}
